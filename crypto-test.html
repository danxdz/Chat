<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Crypto Test</title>
    <script src="/sodium.js"></script>
</head>
<body>
    <h1>Crypto Function Test</h1>
    <div id="status">Testing...</div>
    <div id="results"></div>

    <script type="module">
        import { initSodium, hashPIN } from './src/utils/crypto.js'

        async function test() {
            const status = document.getElementById('status')
            const results = document.getElementById('results')
            
            try {
                status.textContent = 'Initializing sodium...'
                const sodium = await initSodium()
                
                status.textContent = 'Testing PIN hashing...'
                const testPIN = '1234'
                const hash = await hashPIN(testPIN, sodium)
                
                results.innerHTML = `
                    <h2>✅ Test Passed!</h2>
                    <p><strong>Sodium ready:</strong> ${!!sodium}</p>
                    <p><strong>Test PIN:</strong> ${testPIN}</p>
                    <p><strong>Hash:</strong> ${hash}</p>
                    <p><strong>Hash length:</strong> ${hash?.length || 'undefined'}</p>
                `
                status.textContent = 'Test completed successfully!'
                
            } catch (error) {
                results.innerHTML = `
                    <h2>❌ Test Failed!</h2>
                    <p><strong>Error:</strong> ${error.message}</p>
                    <pre>${error.stack}</pre>
                `
                status.textContent = 'Test failed!'
                console.error('Test error:', error)
            }
        }
        
        test()
    </script>
</body>
</html>